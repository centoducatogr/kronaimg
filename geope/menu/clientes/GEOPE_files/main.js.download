var idTab = 'indefinido';

/*Funções para Montar os Menus*/
function MakeMain(id) {

    try {

        const base = window.appBase || '/';

        $.ajax({
            type: 'GET',            
            url: base + 'GetMenu.aspx?ID=' + encodeURIComponent(id) + '&Tipo=0',
            success: function (data) {

                let parser = new DOMParser();
                let xml = parser.parseFromString(data, "text/xml");

                let menus = xml.documentElement.getElementsByTagName("menu");
                for (let i = 0; i < menus.length; i++) {

                    let div = document.createElement("DIV");

                    $(div).addClass("itens-lista");

                    div.role = "button"

                    div.id = "menu" + menus[i].getAttribute("menuID");

                    let img = document.createElement("IMG");

                    img.src = base + menus[i].getAttribute("urlImage");
                  

                    $(div).append(img);

                    let label = document.createElement("LABEL");

                    label.innerHTML = menus[i].getAttribute("menu");


                    $(div).append(label);

                    let divLinks = document.createElement("DIV");

                    $(divLinks).addClass("links");

                    let divConteudo = document.createElement("DIV");

                    $(divConteudo).addClass("conteudo-links scroll");

                    let ul = document.createElement("UL");

                    ul.id = menus[i].getAttribute("menuID");

                    $(ul).attr("parentID", menus[i].getAttribute("parentID"));

                    $(divConteudo).append(ul);

                    $(divLinks).append(divConteudo);

                    $(div).append(divLinks);

                    $("#menu-lateral").append(div);


                }

            },            
            async: false
        });
        

    } catch (err) {
        console.log(err);
    }

};



function MakeParent(id) {

    const base = window.appBase || '/';


    try {

        $.ajax({
            type: 'GET',
            url: base + "GetMenu.aspx?ID=" + id + "&Tipo=1",                        
            success: function (data) {

                let parser = new DOMParser();
                let xml = parser.parseFromString(data, "text/xml");

                let menus = xml.documentElement.getElementsByTagName("menu");
                for (let i = 0; i < menus.length; i++) {


                    let noPai = $('ul#' + menus[i].getAttribute('parentID'));

                    let existSubMenu = parseInt(menus[i].getAttribute('subMenu'), '10');

                    let li = document.createElement("LI");

                    let link = document.createElement("A");

                    if (existSubMenu == 0) {

                        link.href = base + menus[i].getAttribute
                            ("url").replace('~/', '');
                        
                        

                        link.innerHTML = menus[i].getAttribute("menu");

                        $(li).append(link);

                    } else {


                        link.innerHTML = menus[i].getAttribute("menu");

                        $(link).addClass('sub-btn dropdown-toggle');

                        let subMenu = document.createElement("DIV");

                        subMenu.id = 'subMenu' + menus[i].getAttribute("menuID");

                        $(subMenu).addClass('sub-menu');

                        $(link).append(subMenu);

                        $(li).append(link);
                    }

                    $(noPai).append(li);
                }
            },            
            async: false
        });

       

    } catch (err) {
        console.log(err);
    }

};


function MakeSubMenu(id) {

    try {

        const base = window.appBase || '/';

        $.ajax({
            type: 'GET',
            url: base + "GetMenu.aspx?ID=" + id + "&Tipo=2",                       
            success: function (data) {

                let parser = new DOMParser();
                let xml = parser.parseFromString(data, "text/xml");

                let menus = xml.documentElement.getElementsByTagName("menu");
                for (let i = 0; i < menus.length; i++) {

                    let id = '#subMenu' + menus[i].getAttribute('parentID');

                    let noPai = $(id);

                    let link = document.createElement("A");

                    link.href = base + menus[i].getAttribute("url").replace('~/', '');

                    

                    link.innerHTML = menus[i].getAttribute("menu");

                    $(noPai).append(link);



                }

            } ,          
            async: false
        });        

    } catch (err) {
        console.log(err);
    }

};

function changeMenuSize() {

    let heightMenu = parseInt($('#tdConteudo').height());
    heightMenu += 31;

    let propMinHeight = heightMenu.toString() + 'px';

    $('#menu-lateral').css('min-height', propMinHeight);

};


function setTab(id) {

    $('#' + id).tab('show');
    idTab = id;

}



/*Esconder o menu de acordo com o tamanho da tela*/

$(document).ready(function ($) {

    var dispositivo = navigator.userAgent;
    var ww = document.body.clientWidth;
    if (dispositivo.includes('Android') || dispositivo.includes('iPhone')) {
        if (ww < 700) {
            $('nav').hide();
            $('#acesso-rapido').hide();
        } else if (ww >= 701) {
            $('nav').show();
            $('#acesso-rapido').show();
        };
    }

    changeMenuSize();

    $(window).resize(function () {
        changeMenuSize();
    });

    //On UpdatePanel Refresh
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    if (prm != null) {
        prm.add_endRequest(function (sender, e) {
            if (sender._postBackSettings.async == true) {

                if (idTab != 'indefinido') {
                    $('#' + idTab).tab('show');
                }



            }
        });
    };
  
   

});





var barraNav = document.getElementById('navbar').classList[1];

const atalhos = document.getElementById('acesso-rapido');

function botoes (){
  if (barraNav == 'show'){
    atalhos.style.width = '80%'
  }
}



